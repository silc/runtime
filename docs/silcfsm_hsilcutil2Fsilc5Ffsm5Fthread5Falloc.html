<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-type" content="text/html; charset=ISO-8859-1" />
<link rel="stylesheet" href="./robodoc.css" type="text/css" />
<title>silcfsm.h</title>
<!-- Source: ./../../lib/silcutil/silcfsm.h -->
<!-- Generated with ROBODoc Version 4.99.36 (Feb  3 2008) -->
</head>
<body>
<div id="logo">
<table border="0" cellspacing="0" cellpadding="6" width="100%">
 <tr valign="top">
  <td>Copyright &copy; 2001 - 2008 SILC Project<br />
    <a href="http://silc.fi">SILC Project Website</a></td>
  <td align="right">
   <a href="index.html">SILC Runtime Toolkit Manual</a><br />
   <a href="masterindex.html">Index</a></small></td>
  </td>
 </tr>
</table>
</div>

<div id="contentwrapper">
<div id="navigation">
<a class="menuitem" href="silcfsm_hsilcutil2FFinite20State20Machine.html">Finite State Machine</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSilcFSM.html#">SilcFSM</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSilcFSMStruct.html#">SilcFSMStruct</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSilcFSMThread.html#">SilcFSMThread</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSilcFSMThreadStruct.html#">SilcFSMThreadStruct</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FCONTINUE.html#">SILC_FSM_CONTINUE</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FYIELD.html#">SILC_FSM_YIELD</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FWAIT.html#">SILC_FSM_WAIT</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FFINISH.html#">SILC_FSM_FINISH</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSilcFSMDestructor.html#">SilcFSMDestructor</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSilcFSMThreadDestructor.html#">SilcFSMThreadDestructor</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FSTATE.html#">SILC_FSM_STATE</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FCALL.html#">SILC_FSM_CALL</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FCALL5FCONTINUE.html#">SILC_FSM_CALL_CONTINUE</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FCALL5FCONTINUE5FSYNC.html#">SILC_FSM_CALL_CONTINUE_SYNC</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FTHREAD5FWAIT.html#">SILC_FSM_THREAD_WAIT</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Falloc.html#">silc_fsm_alloc</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Finit.html#">silc_fsm_init</a>
<a class="menuitem" href="#">silc_fsm_thread_alloc</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fthread5Finit.html#">silc_fsm_thread_init</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Ffree.html#">silc_fsm_free</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fstart.html#">silc_fsm_start</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fstart5Fsync.html#">silc_fsm_start_sync</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fnext.html#">silc_fsm_next</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fnext5Flater.html#">silc_fsm_next_later</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fcontinue.html#">silc_fsm_continue</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fcontinue5Fsync.html#">silc_fsm_continue_sync</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Ffinish.html#">silc_fsm_finish</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fset5Fcontext.html#">silc_fsm_set_context</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fget5Fcontext.html#">silc_fsm_get_context</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fset5Fstate5Fcontext.html#">silc_fsm_set_state_context</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fget5Fstate5Fcontext.html#">silc_fsm_get_state_context</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fget5Fschedule.html#">silc_fsm_get_schedule</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fget5Fmachine.html#">silc_fsm_get_machine</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fis5Fstarted.html#">silc_fsm_is_started</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSilcFSMEvent.html#">SilcFSMEvent</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSilcFSMEventStruct.html#">SilcFSMEventStruct</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fevent5Falloc.html#">silc_fsm_event_alloc</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fevent5Finit.html#">silc_fsm_event_init</a>
<a class="menuitem" href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fevent5Ffree.html#">silc_fsm_event_free</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FEVENT5FWAIT.html#">SILC_FSM_EVENT_WAIT</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FEVENT5FTIMEDWAIT.html#">SILC_FSM_EVENT_TIMEDWAIT</a>
<a class="menuitem" href="./silcfsm_hsilcutil2FSILC5FFSM5FEVENT5FSIGNAL.html#">SILC_FSM_EVENT_SIGNAL</a>
</div> <!-- navigation -->
<div id="content">
<a name="silcutil2fsilc5ffsm5fthread5falloc">
</a><a name="robo278"></a><h2>silc_fsm_thread_alloc</h2>

<p class="item_name">SYNOPSIS</p>
<pre>    <a href="./silcfsm_hsilcutil2FSilcFSMThread.html#robo293">SilcFSMThread</a> <strong>silc_fsm_thread_alloc</strong>(<a href="./silcfsm_hsilcutil2FSilcFSM.html#robo295">SilcFSM</a> fsm,
                                        void *thread_context,
                                        <a href="./silcfsm_hsilcutil2FSilcFSMThreadDestructor.html#robo286">SilcFSMThreadDestructor</a> destructor,
                                        void *destructor_context,
                                        <a href="./silctypes_hsilcutil2FSilcBool.html#robo720">SilcBool</a> real_thread);
</pre>
<p class="item_name">DESCRIPTION</p>
<p>    Allocates FSM thread context.  The thread will be executed in the
    FSM machine indicated by `fsm'.  The caller must free the returned
    thread context with <a href="./silcfsm_hsilcutil2Fsilc5Ffsm5Ffree.html#robo276">silc_fsm_free</a>.  If the 'real_thread' is <a href="./silctypes_hsilcutil2FTRUE.html#robo719">TRUE</a>
    then the thread will actually be executed in real thread, if platform
    supports them.  The `thread_context' is delivered to every state
    function in the thread.  Returns NULL on error or if the system is out
    of memory and sets <a href="./silcerrno_hsilcutil2Fsilc5Ferrno.html#robo225">silc_errno</a>.
</p>
<p class="item_name">NOTES</p>
<p>    If the system does not support threads, then this function will revert
    back to normal FSM threads.
</p>

<p>    If the `real_thread' is <a href="./silctypes_hsilcutil2FTRUE.html#robo719">TRUE</a> then FSM will allocate new <a href="./silcschedule_hsilcutil2FSilcSchedule.html#robo546">SilcSchedule</a>
    for the FSM thread. If you need scheduler in the real thread it is
    strongly recommended that you use the <a href="./silcschedule_hsilcutil2FSilcSchedule.html#robo546">SilcSchedule</a> that is allocated
    for the thread.  You can retrieve the <a href="./silcschedule_hsilcutil2FSilcSchedule.html#robo546">SilcSchedule</a> from the thread
    using <a href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fget5Fschedule.html#robo264">silc_fsm_get_schedule</a> function.  The new scheduler is a child
    scheduler of the original scheduler used with `fsm'.  Note that, the
    allocated <a href="./silcschedule_hsilcutil2FSilcSchedule.html#robo546">SilcSchedule</a> will become invalid after the thread finishes.
    Note also that the scheduler is automatically set as global scheduler
    in that thread by calling <a href="./silcschedule_hsilcutil2Fsilc5Fschedule5Fset5Fglobal.html#robo527">silc_schedule_set_global</a>.
</p>

<p>    If `real_thread' is <a href="./silctypes_hsilcutil2FFALSE.html#robo718">FALSE</a> the <a href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fget5Fschedule.html#robo264">silc_fsm_get_schedule</a> will return
    the <a href="./silcschedule_hsilcutil2FSilcSchedule.html#robo546">SilcSchedule</a> that was originally given to <a href="./silcfsm_hsilcutil2Fsilc5Ffsm5Falloc.html#robo280">silc_fsm_alloc</a> or
    <a href="./silcfsm_hsilcutil2Fsilc5Ffsm5Finit.html#robo279">silc_fsm_init</a>.
</p>
<p class="item_name">EXAMPLE</p>
<pre>    <a href="./silcfsm_hsilcutil2FSILC5FFSM5FSTATE.html#robo285">SILC_FSM_STATE</a>(silc_foo_state)
    {
      <a href="./silcfsm_hsilcutil2FSilcFSMThread.html#robo293">SilcFSMThread</a> thread;
      ...

      // Execute the route lookup in thread
      thread = <strong>silc_fsm_thread_alloc</strong>(fsm, fsm_context, NULL, NULL, <a href="./silctypes_hsilcutil2FFALSE.html#robo718">FALSE</a>);
      <a href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fstart.html#robo275">silc_fsm_start</a>(thread, silc_route_lookup_start);

      // Wait here for the thread to terminate. Set the state where to go
      // after the thread has terminated.
      <a href="./silcfsm_hsilcutil2Fsilc5Ffsm5Fnext.html#robo273">silc_fsm_next</a>(fsm, silc_foo_route_lookup_finished);
      <a href="./silcfsm_hsilcutil2FSILC5FFSM5FTHREAD5FWAIT.html#robo281">SILC_FSM_THREAD_WAIT</a>(thread);
    }
</pre>

</div> <!-- content -->
</div> <!-- contentwrapper -->
<div id="footer">
<table border="0" cellspacing="0" cellpadding="6" width="100%">
 <tr valign="top">
  <td>Copyright &copy; 2001 - 2008 SILC Project<br />
    <a href="http://silc.fi">SILC Project Website</a></td>
  <td align="right">
   <a href="index.html">SILC Runtime Toolkit Manual</a><br />
   <a href="masterindex.html">Index</a></small></td>
  </td>
 </tr>
</table>
</div>
</body>
</html>
